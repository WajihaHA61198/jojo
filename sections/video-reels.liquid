{% stylesheet %}
  .video-card {
    position: relative;
    width: 100%;
    height: auto;
    overflow: hidden;
  }
  .video-card iframe,
  .video-card video {
    width: 100%;
    height: 400px;
    object-fit: cover;
    border: 0;
  }
{% endstylesheet %}

<section id="video-slider-{{ section.id }}" class="page-width">
  <slider-component class="slider-mobile-gutter">
    <ul
      id="Slider-{{ section.id }}"
      class="slider slider--mobile"
      role="list"
    >
      {% for block in section.blocks %}
        <li
          id="Slide-{{ section.id }}-{{ forloop.index }}"
          class="slider__slide"
          {{ block.shopify_attributes }}
        >
          <div class="video-card">
            {% if block.settings.video_url contains 'youtube' %}
              <iframe
                src="{{ block.settings.video_url | replace: 'watch?v=', 'embed/' }}"
                frameborder="0"
                allow="autoplay; encrypted-media"
                allowfullscreen
              ></iframe>
            {% elsif block.settings.video_url contains 'vimeo' %}
              <iframe
                src="{{ block.settings.video_url | replace: 'vimeo.com', 'player.vimeo.com/video' }}"
                frameborder="0"
                allow="autoplay; fullscreen"
                allowfullscreen
              ></iframe>
            {% else %}
              <video
                src="{{ block.settings.video_url }}"
                playsinline
                controls
              ></video>
            {% endif %}
          </div>
        </li>
      {% endfor %}
    </ul>

    <div class="slider-buttons no-js-hidden">
      <button
        type="button"
        class="slider-button slider-button--prev"
        name="previous"
        aria-label="Previous slide"
      >
        {% render 'global-icons', icon: 'caret' %}
      </button>
      <button
        type="button"
        class="slider-button slider-button--next"
        name="next"
        aria-label="Next slide"
      >
        {% render 'global-icons', icon: 'caret' %}
      </button>
    </div>
  </slider-component>
</section>

{% schema %}
{
  "name": "Video Slider",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [],
  "blocks": [
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "url",
          "id": "video_url",
          "label": "Video URL (YouTube, Vimeo, or MP4)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Video Slider",
      "blocks": [{ "type": "video" }, { "type": "video" }]
    }
  ]
}
{% endschema %}
